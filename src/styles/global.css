/**
 * Fractal Global Styles
 * =====================
 * 
 * Global styles and utility classes for the Fractal application.
 * 
 * This file:
 * 1. Imports tokens and reset (order matters!)
 * 2. Sets up the root layout
 * 3. Provides utility classes for common patterns
 * 
 * Note: Most styles are component-scoped via CSS Modules.
 * This file only contains truly global concerns.
 */

/* Import design tokens first (defines all CSS custom properties) */
@import './tokens.css';

/* Import reset (uses tokens, must come after) */
@import './reset.css';

/* ============================================
 * ROOT LAYOUT
 * Full-height flex container for the app
 * ============================================ */
#root {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* ============================================
 * APP LAYOUT WITH SIDEBARS
 * Main layout structure for the application
 * Stash on left, Probe on right
 * ============================================ */
.app-layout {
  display: flex;
  min-height: 100vh;
  width: 100%;
}

.app-layout .main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  transition: margin-left var(--transition-normal), margin-right var(--transition-normal);
}

/* When stash sidebar is open, offset main content left */
.app-layout.stash-open .main-content {
  margin-left: var(--stash-width-expanded);
}

/* When stash sidebar is collapsed */
.app-layout.stash-collapsed .main-content {
  margin-left: var(--stash-width-collapsed);
}

/* When probe sidebar is open, offset main content right */
.app-layout.probe-open .main-content {
  margin-right: var(--probe-width-expanded);
}

/* When probe sidebar is collapsed */
.app-layout.probe-collapsed .main-content {
  margin-right: var(--probe-width-collapsed);
}

/* ============================================
 * MOBILE LAYOUT
 * ============================================ */
@media (max-width: 768px) {
  /* On mobile, sidebars are overlays - no margin shift */
  .app-layout.stash-open .main-content {
    margin-left: var(--stash-width-collapsed); /* Keep collapsed width visible or 0 if we want it hidden */
  }

  .app-layout.probe-open .main-content {
    margin-right: var(--probe-width-collapsed); /* Keep collapsed width visible or 0 if we want it hidden */
  }
  
  /* If we want to completely hide the content behind the sidebar: */
  .app-layout.stash-open .main-content,
  .app-layout.probe-open .main-content {
     margin-left: 0;
     margin-right: 0;
  }
  
  /* However, since we have a collapsed state, we probably want to keep the margin for the collapsed strip 
     if it's still visible underneath, or just rely on z-index. 
     The plan says: "Ensure .main-content margins are 0 when sidebars are open on mobile."
     But we still have the collapsed sidebar taking up space? 
     Actually, if the sidebar is overlay, the main content should probably stay put. 
     But wait, if the sidebar is 100vw, it covers everything.
     Let's set margins to 0 (or just the collapsed width) so the content doesn't squish.
  */

  /* Reset margins to just the collapsed width (or 0 if we hide collapsed state) 
     The sidebar will overlay everything. */
  .app-layout.stash-open .main-content {
    margin-left: 0;
  }
  
  .app-layout.probe-open .main-content {
    margin-right: 0;
  }

  /* When collapsed, we might still want the little strip, or maybe not on mobile?
     For now, let's assume the collapsed strip is small enough (48px) to stay,
     but if we want full screen real estate, we might even hide the collapsed strip?
     Let's stick to the plan: "Ensure .main-content margins are 0 when sidebars are open on mobile."
     
     Wait, if I set margin to 0, the content will be under the collapsed sidebar?
     The collapsed sidebar is fixed. 
     If I want the content to NOT shift, I should set margin to 0.
     BUT the collapsed sidebar (48px) is still there.
     
     If I set margin to 0, the 48px sidebar will cover the left 48px of content.
     So when CLOSED, we probably still want the 48px margin.
     When OPEN, we definitely want 0 margin because the sidebar is 100vw and covers everything anyway.
     The content shouldn't try to fit in 0px width.
  */
  
  .app-layout.stash-collapsed .main-content {
    margin-left: 48px; /* Maintain space for collapsed bar */
  }

  .app-layout.probe-collapsed .main-content {
    margin-right: 48px; /* Maintain space for collapsed bar */
  }

  /* When open, sidebar is 100vw overlay. 
     We don't want to push content. Content sits behind. */
  .app-layout.stash-open .main-content {
    margin-left: 48px; /* Keep it consistent with collapsed, or 0? 
                        If 0, content jumps left. 
                        Let's keep 48px so it doesn't jump, just gets covered. */
  }

  .app-layout.probe-open .main-content {
    margin-right: 48px;
  }
}

/* ============================================
 * GRAPH VIEW MODE
 * Special layout for 3D graph visualization
 * ============================================ */
.app-layout.graph-view .main-content {
  position: relative;
  overflow: hidden;
}

/* Ensure graph view fills available space */
.app-layout.graph-view .main-content > div:first-of-type {
  flex: 1;
}

/* ============================================
 * TYPOGRAPHY UTILITIES
 * Quick access to typography tokens
 * ============================================ */

/* Font family utilities */
.font-sans {
  font-family: var(--font-sans);
}

.font-mono {
  font-family: var(--font-mono);
}

/* Font size utilities */
.text-xs { font-size: var(--text-xs); }
.text-sm { font-size: var(--text-sm); }
.text-base { font-size: var(--text-base); }
.text-lg { font-size: var(--text-lg); }
.text-xl { font-size: var(--text-xl); }
.text-2xl { font-size: var(--text-2xl); }
.text-3xl { font-size: var(--text-3xl); }
.text-4xl { font-size: var(--text-4xl); }

/* Text color utilities */
.text-primary { color: var(--text-primary); }
.text-secondary { color: var(--text-secondary); }
.text-tertiary { color: var(--text-tertiary); }
.text-error { color: var(--accent-error); }

/* Letter spacing utilities */
.tracking-tight { letter-spacing: var(--tracking-tight); }
.tracking-normal { letter-spacing: var(--tracking-normal); }
.tracking-wide { letter-spacing: var(--tracking-wide); }

/* Line height utilities */
.leading-tight { line-height: var(--leading-tight); }
.leading-normal { line-height: var(--leading-normal); }
.leading-relaxed { line-height: var(--leading-relaxed); }

/* Text transform */
.uppercase {
  text-transform: uppercase;
}

/* ============================================
 * NEOBRUTALIST BORDER UTILITIES
 * Standard and strong border patterns
 * ============================================ */
.border {
  border: var(--border-width) solid var(--border-primary);
}

.border-strong {
  border: var(--border-width-strong) solid var(--text-primary);
}

/* ============================================
 * ACCESSIBILITY UTILITIES
 * ============================================ */

/**
 * Screen reader only content
 * Visually hidden but accessible to screen readers
 */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}
